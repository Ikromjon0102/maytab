{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="fw-bold">üë®‚Äçüéì O'quvchilar ({{ students.count }})</h4>
    <a href="{% url 'student_create' %}" class="btn btn-primary"><i class="fa fa-plus"></i> Yangi qo'shish</a>
</div>

<div class="card p-3 mb-4">
    <form method="get" class="d-flex gap-2">
        <input type="text" name="q" class="form-control" placeholder="Ism, Sinf yoki ID bo'yicha qidirish..." value="{{ query }}">
        <button type="submit" class="btn btn-outline-secondary">Qidirish</button>
    </form>
</div>

<div class="card table-responsive">
    <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
            <tr>
                <th>Rasm</th>
                <th>ID</th>
                <th>F.I.SH</th>
                <th>Sinf</th>
                <th>Ota-ona</th>
                <th>Status</th>
                <th>Amallar</th>
            </tr>
        </thead>
        <tbody>
            {% for s in students %}
            <tr>
                <td>
                    {% if s.photo %}
                        <img src="{{ s.photo.url }}" class="rounded-circle" width="40" height="40" style="object-fit: cover;">
                    {% else %}
                        <div class="bg-secondary rounded-circle d-flex align-items-center justify-content-center text-white" style="width: 40px; height: 40px;">
                            {{ s.full_name|first }}
                        </div>
                    {% endif %}
                </td>
                <td class="fw-bold text-primary">{{ s.hikvision_id }}</td>
                <td>{{ s.full_name }}</td>
                <td><span class="badge bg-info text-dark">{{ s.classroom_name }}</span></td>
                <td>{{ s.parent.phone|default:"-" }}</td>
                <td>
                    {% if s.is_synced %}
                        <i class="fa-solid fa-check-circle text-success" title="Terminalga yuklangan"></i>
                    {% else %}
                        <i class="fa-solid fa-clock text-warning" title="Kutilmoqda..."></i>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'student_edit' s.id %}" class="btn btn-sm btn-light text-primary"><i class="fa fa-edit"></i></a>
                    <a href="{% url 'student_delete' s.id %}" class="btn btn-sm btn-light text-danger"><i class="fa fa-trash"></i></a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="7" class="text-center py-4">O'quvchilar topilmadi</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}